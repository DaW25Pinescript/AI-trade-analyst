<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Trade Analyst ‚Äî V3</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="./styles/theme.css">
<link rel="stylesheet" href="./styles/print.css" media="print">
</head>
<body>

<header class="header">
  <div class="header-left">
    <div class="logo">AI Trade <span>/ Analyst</span></div>
    <div class="version-pill">V3 ¬∑ G2</div>
  </div>
  <div class="ticket-id-header">Ticket: <span id="ticketIdHeader">‚Äî</span></div>
</header>

<main class="main">
  <div class="page-title">Market Analysis Request</div>
  <h1>Build Your Analysis Brief</h1>
  <p class="subtitle">G2 ‚Äî Test / Prediction Mode: record your call before AI analysis ¬∑ Enum-driven ticket fields ¬∑ Full audit trail</p>

  <div class="steps">
    <div class="step active" onclick="goTo(0)"><span class="step-num">01</span>Setup</div>
    <div class="step" onclick="goTo(1)"><span class="step-num">02</span>Charts</div>
    <div class="step" onclick="goTo(2)"><span class="step-num">03</span>Context</div>
    <div class="step" onclick="goTo(3)"><span class="step-num">04</span>Pre-Ticket</div>
    <div class="step" onclick="goTo(4)"><span class="step-num">05</span>Test Mode</div>
    <div class="step" onclick="goTo(5)"><span class="step-num">06</span>Output</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 1: SETUP
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section active" id="section-0">
    <div class="card">
      <div class="card-label">Asset, Session & Platform</div>

      <label>Asset / Ticker</label>
      <input type="text" id="asset" placeholder="e.g. XAUUSD, EURUSD, BTCUSDT" oninput="onAssetInput()">
      <div class="suggestions">
        <span class="sug-pill" onclick="setAsset('XAUUSD')">XAUUSD</span>
        <span class="sug-pill" onclick="setAsset('EURUSD')">EURUSD</span>
        <span class="sug-pill" onclick="setAsset('GBPUSD')">GBPUSD</span>
        <span class="sug-pill" onclick="setAsset('BTCUSDT')">BTCUSDT</span>
        <span class="sug-pill" onclick="setAsset('US30')">US30</span>
        <span class="sug-pill" onclick="setAsset('NAS100')">NAS100</span>
      </div>

      <div class="row">
        <div>
          <label>Session</label>
          <select id="session" onchange="syncOutput()">
            <option value="">‚Äî Select ‚Äî</option>
            <option>London Open</option>
            <option>London Mid</option>
            <option>NY Open</option>
            <option>NY AM</option>
            <option>NY PM / Close</option>
            <option>Asia Session</option>
            <option>Swing / Multi-day</option>
          </select>
        </div>
        <div>
          <label>Execution Horizon</label>
          <select id="execHorizon" onchange="syncOutput()">
            <option value="">‚Äî Select ‚Äî</option>
            <option>Scalp</option>
            <option>Intraday</option>
            <option>Swing</option>
            <option>All ideas</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Broker / Platform</label>
          <select id="broker" onchange="syncOutput()">
            <option>TradingView</option>
            <option>MT5</option>
            <option>cTrader</option>
            <option>Other</option>
          </select>
        </div>
        <div>
          <label>Candle Type</label>
          <select id="candleType" onchange="syncOutput()">
            <option>Normal</option>
            <option>Heikin Ashi</option>
            <option>Renko</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Chart Timezone</label>
          <input type="text" id="chartTimezone" placeholder="e.g. UTC+3, NY time, Server time" oninput="syncOutput()">
        </div>
        <div>
          <label>Price Now (optional)</label>
          <input type="text" id="priceNow" placeholder="e.g. 2934.65" oninput="syncOutput()">
        </div>
      </div>

      <div class="row">
        <div>
          <label>Market Regime</label>
          <select id="regime" onchange="syncOutput()">
            <option value="">‚Äî Select ‚Äî</option>
            <option>Trending</option>
            <option>Ranging</option>
            <option>Volatile / News-driven</option>
            <option>Unsure ‚Äî please assess</option>
          </select>
        </div>
        <div>
          <label>Bias Horizon</label>
          <select id="biasHorizon" onchange="syncOutput()">
            <option value="">‚Äî Select ‚Äî</option>
            <option>HTF swing bias (D/4H)</option>
            <option>Intraday bias (1H/30m)</option>
            <option>Scalp bias (15m/5m)</option>
            <option>Mixed / counter-trend acceptable</option>
          </select>
        </div>
      </div>

      <label>My Current Bias (optional)</label>
      <div class="bias-row">
        <div class="bias-btn" data-val="BULLISH" onclick="setBias(this)">‚ñ≤ Bullish</div>
        <div class="bias-btn" data-val="BEARISH" onclick="setBias(this)">‚ñº Bearish</div>
        <div class="bias-btn" data-val="NEUTRAL" onclick="setBias(this)">‚Äî Neutral</div>
      </div>

      <div class="toggle-wrap">
        <div class="toggle-left">
          <div class="toggle-title">Permission to say "No Trade"</div>
          <div class="toggle-sub">If conditions are poor, WAIT is preferred over a forced ticket.</div>
        </div>
        <label class="switch">
          <input type="checkbox" id="noTradeToggle" onchange="syncOutput()" checked>
          <span class="slider-sw"></span>
        </label>
      </div>

      <div class="row">
        <div>
          <label>Min R:R Required</label>
          <select id="minRR" onchange="syncOutput()">
            <option value="">‚Äî Any ‚Äî</option>
            <option value="1.5">1.5R minimum</option>
            <option value="2">2R minimum</option>
            <option value="2.5">2.5R minimum</option>
            <option value="3">3R minimum</option>
          </select>
        </div>
        <div>
          <label>Allow R:R Exception?</label>
          <select id="rrException" onchange="toggleRRJustification(); syncOutput()">
            <option value="no">No ‚Äî strict filter</option>
            <option value="yes">Yes ‚Äî if win-rate logic is strong</option>
          </select>
        </div>
      </div>
      <div id="rrJustWrap" style="display:none;">
        <label>Exception Justification (required)</label>
        <input type="text" id="rrJustification" placeholder="e.g. High-probability mean reversion with historical 70%+ hit rate" oninput="syncOutput()">
      </div>

      <div class="row">
        <div>
          <label>Max Stop Distance (pips / $)</label>
          <input type="text" id="maxStop" placeholder="e.g. 50 pips, $200" oninput="syncOutput()">
        </div>
        <div>
          <label>Spread / Slippage Assumption</label>
          <input type="text" id="spread" placeholder="e.g. 0.3 pips, $0.50" oninput="syncOutput()">
        </div>
      </div>

      <label>Correlation Context (optional)</label>
      <div class="row">
        <div>
          <input type="text" id="correlationNote" placeholder="e.g. DXY strengthening, SPX risk-off" oninput="syncOutput()" style="margin-bottom:0">
        </div>
        <div>
          <select id="correlationConf" onchange="syncOutput()" style="margin-bottom:0">
            <option value="">‚Äî Confidence ‚Äî</option>
            <option value="Low">Low confidence</option>
            <option value="Med">Medium confidence</option>
            <option value="High">High confidence</option>
          </select>
        </div>
      </div>
      <p class="hint" style="margin-top:6px;">Used as secondary confirmation only ‚Äî never primary justification.</p>

      <label>Persona Override (optional)</label>
      <select id="persona" onchange="syncOutput()">
        <option value="">Default ‚Äî ruthless prop trader</option>
        <option value="ICT purist">ICT purist</option>
        <option value="SMC + Volume Profile">SMC + Volume Profile</option>
        <option value="Pure price action">Pure price action</option>
        <option value="Wyckoff methodology">Wyckoff methodology</option>
      </select>
    </div>

    <div class="btn-row">
      <button class="btn btn-primary" onclick="goTo(1)">Next: Charts ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 2: CHARTS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" id="section-1">
    <div class="card">
      <div class="card-label">Chart Screenshots</div>
      <p class="step-note">Upload a screenshot for each timeframe. At least HTF + Mid TF strongly recommended. Screenshots embed into the HTML export automatically.</p>

      <div class="tf-grid">
        <div class="upload-zone" id="zone-htf" onclick="triggerUpload('upload-htf')">
          <input type="file" id="upload-htf" accept="image/*" onchange="handleUpload(this,'zone-htf','label-htf','htf')">
          <span class="upload-icon">üìà</span>
          <span class="upload-tf-label">HTF</span>
          <span class="upload-desc">Daily / Weekly</span>
          <img class="preview-img" id="prev-htf">
          <span class="upload-filename" id="label-htf"></span>
        </div>
        <div class="upload-zone" id="zone-mid" onclick="triggerUpload('upload-mid')">
          <input type="file" id="upload-mid" accept="image/*" onchange="handleUpload(this,'zone-mid','label-mid','mid')">
          <span class="upload-icon">üìä</span>
          <span class="upload-tf-label">Mid TF</span>
          <span class="upload-desc">4H / 1H</span>
          <img class="preview-img" id="prev-mid">
          <span class="upload-filename" id="label-mid"></span>
        </div>
        <div class="upload-zone" id="zone-ltf" onclick="triggerUpload('upload-ltf')">
          <input type="file" id="upload-ltf" accept="image/*" onchange="handleUpload(this,'zone-ltf','label-ltf','ltf')">
          <span class="upload-icon">üîç</span>
          <span class="upload-tf-label">LTF</span>
          <span class="upload-desc">15m / 5m</span>
          <img class="preview-img" id="prev-ltf">
          <span class="upload-filename" id="label-ltf"></span>
        </div>
        <div class="upload-zone" id="zone-exec" onclick="triggerUpload('upload-exec')">
          <input type="file" id="upload-exec" accept="image/*" onchange="handleUpload(this,'zone-exec','label-exec','exec')">
          <span class="upload-icon">‚ö°</span>
          <span class="upload-tf-label">Exec TF</span>
          <span class="upload-desc">1m / 3m (optional)</span>
          <img class="preview-img" id="prev-exec">
          <span class="upload-filename" id="label-exec"></span>
        </div>
      </div>

      <div class="upload-warning" id="uploadWarning">
        ‚ö† No screenshots uploaded. The AI will still analyse but quality will be limited.
      </div>

      <div class="divider"></div>

      <div class="row">
        <div>
          <label>Screenshot Cleanliness</label>
          <select id="chartCleanliness" onchange="syncOutput()">
            <option value="Clean">Clean ‚Äî no drawings</option>
            <option value="Light">Light drawings ‚Äî some annotations</option>
            <option value="Heavy">Heavy drawings ‚Äî AI should note drawings present</option>
          </select>
        </div>
        <div>
          <label>HTF Context (price location)</label>
          <select id="htfContextSetup" onchange="syncOutput()">
            <option value="">‚Äî Select ‚Äî</option>
            <option>At HTF demand / support</option>
            <option>At HTF supply / resistance</option>
            <option>Mid-range</option>
            <option>Extended above HTF structure</option>
            <option>Extended below HTF structure</option>
            <option>Breaking out of range</option>
          </select>
        </div>
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-ghost" onclick="goTo(0)">‚Üê Back</button>
      <button class="btn btn-primary" onclick="goToChartsNext()">Next: Context ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 3: CONTEXT + ANALYSIS REQUESTS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" id="section-2">
    <div class="card">
      <div class="card-label">Market Context</div>

      <label>Indicators on chart</label>
      <input type="text" id="indicators" placeholder="e.g. EMA 50/200, ICT FVG, Fibonacci, SR Zones" oninput="syncOutput()">

      <label>Key levels I already see</label>
      <textarea id="levels" placeholder="e.g. Resistance at 2950 (previous swing high). Support at 2898 (HTF demand zone). Trendline from Jan lows." oninput="syncOutput()"></textarea>

      <label>Upcoming news / events</label>
      <input type="text" id="news" placeholder="e.g. CPI tomorrow 8:30 ET, FOMC next week" oninput="syncOutput()">

      <label>Any open positions?</label>
      <input type="text" id="position" placeholder="e.g. Long XAUUSD from 2880, SL at 2855" oninput="syncOutput()">
    </div>

    <div class="card">
      <div class="card-label">Analysis Requests</div>
      <div class="checkbox-grid" id="requests">
        <label class="checkbox-item checked" onclick="toggleCheck(this)">
          <input type="checkbox" checked><div class="check-box">‚úì</div>
          <span class="check-text">Trend & key levels per TF</span>
        </label>
        <label class="checkbox-item checked" onclick="toggleCheck(this)">
          <input type="checkbox" checked><div class="check-box">‚úì</div>
          <span class="check-text">Primary trade ticket</span>
        </label>
        <label class="checkbox-item checked" onclick="toggleCheck(this)">
          <input type="checkbox" checked><div class="check-box">‚úì</div>
          <span class="check-text">No-trade conditions</span>
        </label>
        <label class="checkbox-item checked" onclick="toggleCheck(this)">
          <input type="checkbox" checked><div class="check-box">‚úì</div>
          <span class="check-text">Kill-switch conditions</span>
        </label>
        <label class="checkbox-item" onclick="toggleCheck(this)">
          <input type="checkbox"><div class="check-box"></div>
          <span class="check-text">Conditional alternative ticket</span>
        </label>
        <label class="checkbox-item" onclick="toggleCheck(this)">
          <input type="checkbox"><div class="check-box"></div>
          <span class="check-text">Liquidity analysis</span>
        </label>
        <label class="checkbox-item" onclick="toggleCheck(this)">
          <input type="checkbox"><div class="check-box"></div>
          <span class="check-text">HTF/LTF confluence</span>
        </label>
        <label class="checkbox-item" onclick="toggleCheck(this)">
          <input type="checkbox"><div class="check-box"></div>
          <span class="check-text">Invalidation scenarios</span>
        </label>
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-ghost" onclick="goTo(1)">‚Üê Back</button>
      <button class="btn btn-primary" onclick="goTo(3)">Next: Pre-Ticket ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 4: PRE-TICKET CHECKLIST (mandatory gate)
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" id="section-3">
    <div class="card">
      <div class="card-label amber">Pre-Ticket Checklist <span class="gate-badge" id="gateBadge">INCOMPLETE</span></div>
      <p class="step-note">Complete all 8 fields. This is your structural read before the AI commits to a ticket. The gate logic will warn you if conditions suggest WAIT.</p>

      <!-- 1. HTF State -->
      <div class="ptc-row">
        <label>1 ¬∑ HTF State</label>
        <div class="radio-group" id="rg-htfState">
          <div class="radio-opt" data-val="Trending" data-sel="sel-trending" onclick="selectRadio('htfState',this)">Trending</div>
          <div class="radio-opt" data-val="Ranging" data-sel="sel-ranging" onclick="selectRadio('htfState',this)">Ranging</div>
          <div class="radio-opt" data-val="Transition" data-sel="sel-transition" onclick="selectRadio('htfState',this)">Transition</div>
        </div>
      </div>

      <!-- 2. HTF Location -->
      <div class="ptc-row">
        <label>2 ¬∑ HTF Location</label>
        <div class="radio-group" id="rg-htfLocation">
          <div class="radio-opt" data-val="At POI" data-sel="sel-poi" onclick="selectRadio('htfLocation',this)">At POI</div>
          <div class="radio-opt" data-val="Mid-range" data-sel="sel-midrange" onclick="selectRadio('htfLocation',this)">Mid-range</div>
          <div class="radio-opt" data-val="At extremes" data-sel="sel-extremes" onclick="selectRadio('htfLocation',this)">At extremes</div>
        </div>
      </div>

      <!-- 3. LTF Alignment -->
      <div class="ptc-row">
        <label>3 ¬∑ LTF Alignment</label>
        <div class="radio-group" id="rg-ltfAlignment">
          <div class="radio-opt" data-val="Aligned" data-sel="sel-aligned" onclick="selectRadio('ltfAlignment',this)">Aligned with HTF</div>
          <div class="radio-opt" data-val="Counter-trend" data-sel="sel-counter" onclick="selectRadio('ltfAlignment',this)">Counter-trend</div>
          <div class="radio-opt" data-val="Mixed" data-sel="sel-mixed" onclick="selectRadio('ltfAlignment',this)">Mixed</div>
        </div>
      </div>

      <!-- 4. Liquidity Context -->
      <div class="ptc-row">
        <label>4 ¬∑ Liquidity Context</label>
        <div class="radio-group" id="rg-liquidityContext">
          <div class="radio-opt" data-val="Near obvious highs/lows" data-sel="sel-nearliq" onclick="selectRadio('liquidityContext',this)">Near obvious highs/lows</div>
          <div class="radio-opt" data-val="Equilibrium" data-sel="sel-eq" onclick="selectRadio('liquidityContext',this)">Equilibrium</div>
          <div class="radio-opt" data-val="None identified" data-sel="sel-none" onclick="selectRadio('liquidityContext',this)">None identified</div>
        </div>
      </div>

      <!-- 5. Volatility / News Risk -->
      <div class="ptc-row">
        <label>5 ¬∑ Volatility / News Risk</label>
        <div class="radio-group" id="rg-volRisk">
          <div class="radio-opt" data-val="Normal" data-sel="sel-normal" onclick="selectRadio('volRisk',this)">Normal</div>
          <div class="radio-opt" data-val="Elevated" data-sel="sel-elevated" onclick="selectRadio('volRisk',this)">Elevated</div>
        </div>
      </div>

      <!-- 6. Execution Quality -->
      <div class="ptc-row">
        <label>6 ¬∑ Execution Quality</label>
        <div class="radio-group" id="rg-execQuality">
          <div class="radio-opt" data-val="Clean" data-sel="sel-clean" onclick="selectRadio('execQuality',this)">Clean</div>
          <div class="radio-opt" data-val="Messy" data-sel="sel-messy" onclick="selectRadio('execQuality',this)">Messy</div>
          <div class="radio-opt" data-val="Chop" data-sel="sel-chop" onclick="selectRadio('execQuality',this)">Chop</div>
        </div>
      </div>

      <!-- 7. My Conviction Before AI -->
      <div class="ptc-row">
        <label>7 ¬∑ My Conviction Level (before AI)</label>
        <div class="radio-group" id="rg-conviction">
          <div class="radio-opt" data-val="Very High" data-sel="sel-veryhigh" onclick="selectRadio('conviction',this)">Very High</div>
          <div class="radio-opt" data-val="High" data-sel="sel-high" onclick="selectRadio('conviction',this)">High</div>
          <div class="radio-opt" data-val="Medium" data-sel="sel-medium" onclick="selectRadio('conviction',this)">Medium</div>
          <div class="radio-opt" data-val="Low" data-sel="sel-low" onclick="selectRadio('conviction',this)">Low</div>
        </div>
      </div>

      <!-- 8. Personal Edge Tag -->
      <div class="ptc-row">
        <label>8 ¬∑ My Personal Edge Tag on This Setup</label>
        <div class="radio-group" id="rg-edgeTag">
          <div class="radio-opt" data-val="High-probability pullback" data-sel="sel-aligned" onclick="selectRadio('edgeTag',this)">Pullback</div>
          <div class="radio-opt" data-val="Liquidity grab" data-sel="sel-poi" onclick="selectRadio('edgeTag',this)">Liquidity grab</div>
          <div class="radio-opt" data-val="FVG reclaim" data-sel="sel-trending" onclick="selectRadio('edgeTag',this)">FVG reclaim</div>
          <div class="radio-opt" data-val="Structure BOS" data-sel="sel-transition" onclick="selectRadio('edgeTag',this)">Structure BOS</div>
          <div class="radio-opt" data-val="Range boundary" data-sel="sel-ranging" onclick="selectRadio('edgeTag',this)">Range boundary</div>
          <div class="radio-opt" data-val="Other" data-sel="sel-none" onclick="selectRadio('edgeTag',this)">Other</div>
        </div>
      </div>

      <!-- Confluence Slider -->
      <div class="slider-wrap">
        <div class="slider-header">
          <div class="slider-label">Confluence Score (your gut-feel, pre-AI)</div>
          <div class="slider-val" id="confVal">7</div>
        </div>
        <input type="range" id="confluenceScore" min="1" max="10" value="7" oninput="onSlider()">
        <div class="slider-subtext">1 = very weak ¬∑ 5 = moderate ¬∑ 10 = highest conviction. This will be tracked vs outcomes.</div>
      </div>

      <!-- Gate Status -->
      <div class="gate-status" id="gateStatus">
        <div class="gate-dot"></div>
        <span id="gateText">Complete all 8 fields to see gate decision.</span>
      </div>

      <!-- WAIT Panel (shown when gate logic fires) -->
      <div class="wait-panel" id="waitPanel">
        <label>‚ö† WAIT Reason Code</label>
        <select id="waitReason" onchange="syncOutput()">
          <option value="">‚Äî Select reason ‚Äî</option>
          <option>Chop / range noise</option>
          <option>HTF-LTF conflict</option>
          <option>No POI / poor R:R</option>
          <option>News risk / volatility</option>
          <option>Already moved / late trend</option>
        </select>
        <label>Re-entry Condition (what would change WAIT to trade?)</label>
        <input type="text" id="reentryCondition" placeholder="e.g. Price sweeps 2890 liquidity and reclaims 2895 on 15m close" oninput="syncOutput()">
        <label>Time horizon for re-evaluation</label>
        <input type="text" id="reentryTime" placeholder="e.g. Re-check in 2H at NY open" oninput="syncOutput()">
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-ghost" onclick="goTo(2)">‚Üê Back</button>
      <button class="btn btn-primary" onclick="goTo(4)">Next: Test Mode ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 5: TEST / PREDICTION MODE
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" id="section-4">
    <div class="card">
      <div class="card-label amber">Test / Prediction Mode ‚Äî Your Call Before AI</div>
      <p class="step-note">Record your prediction before seeing AI analysis. These values pre-fill the structured TRADE TICKET block in the generated prompt and are saved in JSON exports.</p>

      <div class="row">
        <div>
          <label>Decision Mode</label>
          <select id="decisionMode" onchange="onDecisionModeChange(this)">
            <option value="LONG">LONG</option>
            <option value="SHORT">SHORT</option>
            <option value="WAIT" selected>WAIT</option>
            <option value="CONDITIONAL">CONDITIONAL</option>
          </select>
        </div>
        <div>
          <label>Ticket Type</label>
          <select id="ticketType" onchange="syncOutput()">
            <option value="Zone ticket">Zone ticket (default)</option>
            <option value="Exact ticket">Exact ticket</option>
          </select>
        </div>
      </div>

      <div id="conditionalWrap" style="display:none;">
        <label>Conditional Alternative (if Decision = CONDITIONAL)</label>
        <textarea id="conditionalText" placeholder="Describe the alternative scenario or trigger that would change the direction..." oninput="syncOutput()"></textarea>
      </div>

      <div class="row">
        <div>
          <label>Entry Type</label>
          <select id="entryType" onchange="syncOutput()">
            <option value="Market">Market</option>
            <option value="Limit" selected>Limit</option>
            <option value="Stop">Stop</option>
          </select>
        </div>
        <div>
          <label>Entry Trigger Type</label>
          <select id="entryTrigger" onchange="syncOutput()">
            <option value="Pullback to zone">Pullback to zone</option>
            <option value="Break + retest">Break + retest</option>
            <option value="Sweep + reclaim">Sweep + reclaim</option>
            <option value="Close above/below level">Close above/below level</option>
            <option value="Momentum shift (MSS/BOS)">Momentum shift (MSS/BOS)</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Confirmation Timeframe</label>
          <select id="confTF" onchange="syncOutput()">
            <option value="1m">1m</option>
            <option value="5m">5m</option>
            <option value="15m">15m</option>
            <option value="1H" selected>1H</option>
          </select>
        </div>
        <div>
          <label>Stop Logic</label>
          <select id="stopLogic" onchange="syncOutput()">
            <option value="Below swing low / above swing high">Below swing low / above swing high</option>
            <option value="Below zone">Below zone</option>
            <option value="ATR-based">ATR-based</option>
            <option value="Structure-based + buffer">Structure-based + buffer</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>Time-in-Force</label>
          <select id="timeInForce" onchange="syncOutput()">
            <option value="This session">This session</option>
            <option value="Next 1H">Next 1H</option>
            <option value="24H">24H</option>
            <option value="Custom">Custom</option>
          </select>
        </div>
        <div>
          <label>Max Entry Attempts</label>
          <select id="maxAttempts" onchange="syncOutput()">
            <option value="1">1</option>
            <option value="2" selected>2</option>
          </select>
        </div>
      </div>

      <div class="toggle-wrap">
        <div class="toggle-left">
          <div class="toggle-title">Ask AI for missing info before committing a trade</div>
          <div class="toggle-sub">AI will request any data gaps before producing a ticket.</div>
        </div>
        <label class="switch">
          <input type="checkbox" id="askMissing" onchange="syncOutput()" checked>
          <span class="slider-sw"></span>
        </label>
      </div>
    </div>

    <div class="btn-row">
      <button class="btn btn-ghost" onclick="goTo(3)">‚Üê Back to Pre-Ticket</button>
      <button class="btn btn-primary" onclick="buildAndShow()">Generate V3 Prompt ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       STEP 6: OUTPUT
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="section" id="section-5">
    <div class="card">
      <div class="card-label green">Generated Prompt ‚Äî V3</div>
      <p class="step-note">Copy & paste into Claude. Attach your chart screenshots in the same message. Ticket ID and timestamp are embedded.</p>

      <div class="output-panel">
        <div class="output-header">
          <span class="output-title">‚óè PROMPT READY ¬∑ <span id="outputTicketId">‚Äî</span></span>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button class="copy-btn" onclick="copyPrompt()">Copy Prompt</button>
            <button class="export-btn" onclick="exportHTML()">Download HTML</button>
            <button class="export-btn" onclick="exportPDF()">Print / PDF</button>
          </div>
        </div>
        <div id="outputText">Fill in the form steps to generate your V3 prompt...</div>
      </div>
    </div>

    <div class="card">
      <div class="card-label">Charts to Attach</div>
      <div id="attachChecklist" style="font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--muted);line-height:2.1;white-space:pre;"></div>
    </div>

    <div class="btn-row">
      <button class="btn btn-ghost" onclick="goTo(4)">‚Üê Edit Test Mode</button>
      <button class="btn btn-primary" onclick="resetForm()">New Ticket</button>
    </div>
  </div>

</main>
<script type="module" src="./scripts/main.js"></script>
</body>
</html>
